version: 2.1

jobs:
  buildandtest:
    docker:
      - image: cimg/python:3.10
    steps:
      - checkout
      - run: python3 -m pip install .
      - run: python3 -m pip install pytest
      - run: python3 -m pytest
      - codecov/upload:
          file: './coverage/integration/clover.xml'

orbs:
  codecov: codecov/codecov@3.2.4

workflows:
  mergeToMain:
    jobs:
      - buildandtest:
          context: CodeCov
          filters:
            branches:
              ignore: main
#TODO versioning